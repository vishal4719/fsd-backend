import{a as M,b as p,c as x,d as S,f as I,h as O,i as k,m as F,n as R}from"./chunk-GJFRIYG5.js";import{b as v,d as b,i as _,k as h,p as C,r as y}from"./chunk-YLNKWVWQ.js";import{Ea as d,Ka as a,Ma as s,Na as i,Oa as w,Qa as P,Ra as c,Sa as l,Ua as u,Wa as f,qa as o,va as m,za as g}from"./chunk-L5ZCWPZT.js";var E=r=>({"is-invalid":r});function G(r,n){if(r&1&&(s(0,"div",15),l(1),i()),r&2){let t=c();o(),u(" ",t.message," ")}}function q(r,n){if(r&1&&(s(0,"div",16),l(1),i()),r&2){let t=c();o(),u(" ",t.errorMessage," ")}}function j(r,n){r&1&&(s(0,"small"),l(1,"Password is required"),i())}function D(r,n){r&1&&(s(0,"small"),l(1,"Password must be at least 8 characters"),i())}function V(r,n){if(r&1&&(s(0,"div",17),d(1,j,2,0,"small",18)(2,D,2,0,"small",18),i()),r&2){let t=c();o(),a("ngIf",t.newPassword==null||t.newPassword.errors==null?null:t.newPassword.errors.required),o(),a("ngIf",t.newPassword==null||t.newPassword.errors==null?null:t.newPassword.errors.minlength)}}function z(r,n){r&1&&(s(0,"small"),l(1,"Please confirm your password"),i())}function A(r,n){r&1&&(s(0,"small"),l(1,"Passwords do not match"),i())}function B(r,n){if(r&1&&(s(0,"div",17),d(1,z,2,0,"small",18)(2,A,2,0,"small",18),i()),r&2){let t=c();o(),a("ngIf",t.confirmPassword==null||t.confirmPassword.errors==null?null:t.confirmPassword.errors.required),o(),a("ngIf",t.resetPasswordForm.errors==null?null:t.resetPasswordForm.errors.mismatch)}}var N=class r{constructor(n,t,e,T){this.fb=n;this.http=t;this.router=e;this.route=T;this.resetPasswordForm=this.fb.group({newPassword:["",[p.required,p.minLength(8)]],confirmPassword:["",[p.required]]},{validators:this.passwordMatchValidator})}resetPasswordForm;isSubmitting=!1;message="";errorMessage="";token="";ngOnInit(){this.route.queryParams.subscribe(n=>{this.token=n.token,this.token||(this.errorMessage="Invalid or missing reset token")})}passwordMatchValidator(n){let t=n.get("newPassword")?.value,e=n.get("confirmPassword")?.value;return t===e?null:{mismatch:!0}}onSubmit(){if(this.resetPasswordForm.invalid||!this.token)return;this.isSubmitting=!0,this.errorMessage="",this.message="";let n=this.resetPasswordForm.get("newPassword")?.value;this.http.post("198.96.89.132:8080/api/auth/reset-password",null,{params:{token:this.token,newPassword:n},responseType:"text"}).subscribe({next:t=>{this.message="Password has been reset successfully",setTimeout(()=>{this.router.navigate(["/login"])},2e3)},error:t=>{this.errorMessage=t.error||"Failed to reset password. Please try again.",this.isSubmitting=!1}})}get newPassword(){return this.resetPasswordForm.get("newPassword")}get confirmPassword(){return this.resetPasswordForm.get("confirmPassword")}static \u0275fac=function(t){return new(t||r)(m(F),m(h),m(y),m(C))};static \u0275cmp=g({type:r,selectors:[["app-reset-password"]],decls:24,vars:13,consts:[[1,"auth-container"],[1,"auth-card"],[1,"auth-title"],[1,"auth-form",3,"ngSubmit","formGroup"],["class","alert alert-success",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"form-group"],["for","newPassword"],["type","password","id","newPassword","formControlName","newPassword","placeholder","Enter new password","autocomplete","new-password",1,"form-control",3,"ngClass"],["class","error-message",4,"ngIf"],["for","confirmPassword"],["type","password","id","confirmPassword","formControlName","confirmPassword","placeholder","Confirm new password","autocomplete","new-password",1,"form-control",3,"ngClass"],["type","submit",1,"btn","btn-primary","btn-block",3,"disabled"],[1,"auth-links"],["routerLink","/login"],[1,"alert","alert-success"],[1,"alert","alert-danger"],[1,"error-message"],[4,"ngIf"]],template:function(t,e){t&1&&(s(0,"div",0)(1,"div",1)(2,"h2",2),l(3,"Reset Password"),i(),s(4,"form",3),P("ngSubmit",function(){return e.onSubmit()}),d(5,G,2,1,"div",4)(6,q,2,1,"div",5),s(7,"div",6)(8,"label",7),l(9,"New Password"),i(),w(10,"input",8),d(11,V,3,2,"div",9),i(),s(12,"div",6)(13,"label",10),l(14,"Confirm Password"),i(),w(15,"input",11),d(16,B,3,2,"div",9),i(),s(17,"button",12),l(18),i(),s(19,"div",13)(20,"p"),l(21,"Remember your password? "),s(22,"a",14),l(23,"Back to Login"),i()()()()()()),t&2&&(o(4),a("formGroup",e.resetPasswordForm),o(),a("ngIf",e.message),o(),a("ngIf",e.errorMessage),o(4),a("ngClass",f(9,E,(e.newPassword==null?null:e.newPassword.invalid)&&((e.newPassword==null?null:e.newPassword.dirty)||(e.newPassword==null?null:e.newPassword.touched)))),o(),a("ngIf",(e.newPassword==null?null:e.newPassword.invalid)&&((e.newPassword==null?null:e.newPassword.dirty)||(e.newPassword==null?null:e.newPassword.touched))),o(4),a("ngClass",f(11,E,(e.confirmPassword==null?null:e.confirmPassword.invalid)&&((e.confirmPassword==null?null:e.confirmPassword.dirty)||(e.confirmPassword==null?null:e.confirmPassword.touched)))),o(),a("ngIf",(e.confirmPassword==null?null:e.confirmPassword.invalid)&&((e.confirmPassword==null?null:e.confirmPassword.dirty)||(e.confirmPassword==null?null:e.confirmPassword.touched))),o(),a("disabled",e.resetPasswordForm.invalid||e.isSubmitting),o(),u(" ",e.isSubmitting?"Resetting...":"Reset Password"," "))},dependencies:[R,I,M,x,S,O,k,_,v,b],styles:[".auth-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f5f5f5;padding:20px}.auth-card[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:8px;box-shadow:0 2px 4px #0000001a;width:100%;max-width:400px}.auth-title[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem;color:#333}.auth-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-control[_ngcontent-%COMP%]{padding:.75rem;border:1px solid #ddd;border-radius:4px;font-size:1rem;transition:border-color .2s}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff}.form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.error-message[_ngcontent-%COMP%]{color:#dc3545;font-size:.875rem}.btn[_ngcontent-%COMP%]{padding:.75rem;border:none;border-radius:4px;font-size:1rem;cursor:pointer;transition:background-color .2s}.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#0056b3}.btn-primary[_ngcontent-%COMP%]:disabled{background-color:#6c757d;cursor:not-allowed}.btn-block[_ngcontent-%COMP%]{width:100%}.alert[_ngcontent-%COMP%]{padding:.75rem;border-radius:4px;margin-bottom:1rem}.alert-success[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724;border:1px solid #c3e6cb}.alert-danger[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.auth-links[_ngcontent-%COMP%]{text-align:center;margin-top:1rem;font-size:.875rem}.auth-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#007bff;text-decoration:none}.auth-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}"]})};export{N as ResetPasswordComponent};
