import{a as R}from"./chunk-YCD7QI3S.js";import{a as T}from"./chunk-QJVGMPDY.js";import{d as S,e as D,f as C,g as I,h as E,i as w,r as y}from"./chunk-YLNKWVWQ.js";import{Ea as l,Ka as d,Ma as o,Na as a,Pa as f,Qa as _,Ra as s,Sa as r,Ta as m,Ua as h,X as v,Xa as g,Y as u,Ya as x,qa as n,va as p,za as b}from"./chunk-L5ZCWPZT.js";function N(t,i){t&1&&(o(0,"div",4),r(1,"Loading dashboard..."),a())}function k(t,i){if(t&1&&(o(0,"div",5),r(1),a()),t&2){let e=s();n(),m(e.error)}}function F(t,i){if(t&1&&(o(0,"div",15)(1,"p")(2,"strong"),r(3,"Participation Status:"),a(),r(4),a()()),t&2){let e=s(3);n(4),h(" ",e.dashboardData.hasSubmittedForm?"Form Submitted":"Form Not Submitted"," ")}}function j(t,i){if(t&1&&(o(0,"div",13)(1,"p"),r(2,"As a user, you can browse and participate in events."),a(),l(3,F,5,1,"div",14),a()),t&2){let e=s(2);n(3),d("ngIf",e.dashboardData.hasSubmittedForm!==void 0)}}function M(t,i){t&1&&(o(0,"div",13)(1,"p"),r(2,"As an event manager, you can create and manage events."),a()())}function O(t,i){t&1&&(o(0,"div",13)(1,"p"),r(2,"Invalid role or unauthorized access."),a()())}function V(t,i){if(t&1&&(o(0,"div",16)(1,"h3"),r(2,"Dashboard Data"),a(),o(3,"pre"),r(4),g(5,"json"),a()()),t&2){let e=s(2);n(4),m(x(5,1,e.dashboardData))}}function L(t,i){if(t&1){let e=f();o(0,"div",6)(1,"header")(2,"h1"),r(3),a(),o(4,"button",7),_("click",function(){v(e);let A=s();return u(A.logout())}),r(5,"Logout"),a()(),o(6,"div",8)(7,"h2"),r(8),a(),o(9,"p"),r(10),a(),o(11,"div",9),l(12,j,4,1,"div",10)(13,M,3,0,"div",10)(14,O,3,0,"div",11),a()(),l(15,V,6,3,"div",12),a()}if(t&2){let e=s();n(3),h("Welcome to ",e.dashboardData.role," Dashboard"),n(5),m(e.dashboardData.message),n(2),h("Welcome back, ",e.dashboardData.username,"!"),n(),d("ngSwitch",e.dashboardData.role),n(),d("ngSwitchCase","USER"),n(),d("ngSwitchCase","TASK_MANAGER"),n(2),d("ngIf",e.dashboardData)}}var P=class t{constructor(i,e,c){this.authService=i;this.participationService=e;this.router=c}dashboardData=null;loading=!0;error=null;ngOnInit(){this.loadDashboard()}loadDashboard(){this.loading=!0,this.error=null,this.authService.getDashboard().subscribe({next:i=>{console.log("Dashboard data:",i),this.dashboardData=i,i.role==="USER"?this.checkParticipationRedirect():this.loading=!1},error:i=>{console.error("Dashboard error:",i),this.error=i.message||"Failed to load dashboard",this.loading=!1}})}checkParticipationRedirect(){this.participationService.getStatus().subscribe({next:i=>{this.loading=!1,i.hasSubmittedForm||this.router.navigate(["/participation"])},error:i=>{console.error("Participation status check failed:",i),this.loading=!1}})}logout(){this.authService.logout()}static \u0275fac=function(e){return new(e||t)(p(T),p(R),p(y))};static \u0275cmp=b({type:t,selectors:[["app-dashboard"]],decls:4,vars:3,consts:[[1,"dashboard-container"],["class","loading",4,"ngIf"],["class","error",4,"ngIf"],["class","dashboard-content",4,"ngIf"],[1,"loading"],[1,"error"],[1,"dashboard-content"],[1,"logout-btn",3,"click"],[1,"role-specific-content"],[3,"ngSwitch"],["class","role-content",4,"ngSwitchCase"],["class","role-content",4,"ngSwitchDefault"],["class","dashboard-data",4,"ngIf"],[1,"role-content"],["class","participation-status",4,"ngIf"],[1,"participation-status"],[1,"dashboard-data"]],template:function(e,c){e&1&&(o(0,"div",0),l(1,N,2,0,"div",1)(2,k,2,1,"div",2)(3,L,16,7,"div",3),a()),e&2&&(n(),d("ngIf",c.loading),n(),d("ngIf",c.error),n(),d("ngIf",c.dashboardData))},dependencies:[w,S,D,C,I,E],encapsulation:2})};export{P as DashboardComponent};
